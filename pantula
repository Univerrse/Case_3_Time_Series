pantula_test <- function(series, max_order) {
  d <- max_order
  while (d > 0) {
    # Perform ADF test on d'th difference series using boot_adf function
    test_result <- adf(diff(series,differences=d))
    # Check if the null hypothesis of a unit root cannot be rejected
    if (test_result$p.value <= 0.05) {
      d <- d - 1
    } else {
      cat("Order of integration is", d+1, "\n")
      break
    }
  }
  if (d == 0){
    test_result<-adf(series)
    # Check if the null hypothesis of a unit root cannot be rejected
    if (test_result$p.value <= 0.05) {
      cat("Order of integration is", d, "\n")
    } else {
      cat("Order of integration is", d+1, "\n")
    }} else{
      break
    }
}


#perform asymptotic ADF tests for all series
pantula_test(ds$M3,2)
pantula_test(ds$M6,2)
pantula_test(ds$Y1,2)
pantula_test(ds$Y2,2)
pantula_test(ds$Y3,2)
pantula_test(ds$Y5,2)
pantula_test(ds$Y7,2)
pantula_test(ds$Y10,2)
